<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    
    <title>project_1 | Linsen</title>
    <meta name="viewport" content="width=device-width,minimum-scale=1">
    <meta name="generator" content="Hugo 0.75.1" />
    
    
      <META NAME="ROBOTS" CONTENT="NOINDEX, NOFOLLOW">
    

    
    
      <link href="/LinsenTaixian/dist/css/app.4fc0b62e4b82c997bb0041217cd6b979.css" rel="stylesheet">
    

    

    
      

    

    
    
    <meta property="og:title" content="project_1" />
<meta property="og:description" content="快速幂运算和矩阵快速幂运算 快速幂运算 题:既求一个数的n次方,其中n特别大, 最后的结果对k取余
例如$ a^{22}$ 其中$ 22$的二进制表示为$ 10110$, 所以可以通过一直计算$ x$的平方, 然后在n的二进制为一的地方乘以res, 就可以得到下面的额算法
typedef long long ll; ll mod_pow(ll x, ll n, ll mod_k){ ll res = 1; while(n &gt; 0){ if(n&amp;1) res = x*x%mod_k; x = x*x%mod_k; n&gt;&gt;= 1; } return res; } 或者:
或者也可以采用另外一种理解使用递归函数$n$ 为偶数时, 其递归是$a^n = (a^2)^{\frac{n}{2}}$ , 如果是奇数, 也可以递归成 $ a^n = {(a^2)}^{\frac{n- 1}{2}}\times a$ , 就是下面的代码所示
typedef long long ll; ll mod_pow(ll x, ll n, ll mod_k){ if(n == 0) return 1; ll res = mod_pow(x*x%mod_k, n/2, mod_k); if(n&amp;1) res = res*x%mod_k; return res; } 矩阵的快速幂运算 两个矩阵的快速运算为" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://linsentaixian.github.io/LinsenTaixian/posts/project_1/" />
<meta property="article:published_time" content="2020-10-29T20:25:00+08:00" />
<meta property="article:modified_time" content="2020-10-29T20:25:00+08:00" />
<meta itemprop="name" content="project_1">
<meta itemprop="description" content="快速幂运算和矩阵快速幂运算 快速幂运算 题:既求一个数的n次方,其中n特别大, 最后的结果对k取余
例如$ a^{22}$ 其中$ 22$的二进制表示为$ 10110$, 所以可以通过一直计算$ x$的平方, 然后在n的二进制为一的地方乘以res, 就可以得到下面的额算法
typedef long long ll; ll mod_pow(ll x, ll n, ll mod_k){ ll res = 1; while(n &gt; 0){ if(n&amp;1) res = x*x%mod_k; x = x*x%mod_k; n&gt;&gt;= 1; } return res; } 或者:
或者也可以采用另外一种理解使用递归函数$n$ 为偶数时, 其递归是$a^n = (a^2)^{\frac{n}{2}}$ , 如果是奇数, 也可以递归成 $ a^n = {(a^2)}^{\frac{n- 1}{2}}\times a$ , 就是下面的代码所示
typedef long long ll; ll mod_pow(ll x, ll n, ll mod_k){ if(n == 0) return 1; ll res = mod_pow(x*x%mod_k, n/2, mod_k); if(n&amp;1) res = res*x%mod_k; return res; } 矩阵的快速幂运算 两个矩阵的快速运算为">
<meta itemprop="datePublished" content="2020-10-29T20:25:00+08:00" />
<meta itemprop="dateModified" content="2020-10-29T20:25:00+08:00" />
<meta itemprop="wordCount" content="619">



<meta itemprop="keywords" content="" />
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="project_1"/>
<meta name="twitter:description" content="快速幂运算和矩阵快速幂运算 快速幂运算 题:既求一个数的n次方,其中n特别大, 最后的结果对k取余
例如$ a^{22}$ 其中$ 22$的二进制表示为$ 10110$, 所以可以通过一直计算$ x$的平方, 然后在n的二进制为一的地方乘以res, 就可以得到下面的额算法
typedef long long ll; ll mod_pow(ll x, ll n, ll mod_k){ ll res = 1; while(n &gt; 0){ if(n&amp;1) res = x*x%mod_k; x = x*x%mod_k; n&gt;&gt;= 1; } return res; } 或者:
或者也可以采用另外一种理解使用递归函数$n$ 为偶数时, 其递归是$a^n = (a^2)^{\frac{n}{2}}$ , 如果是奇数, 也可以递归成 $ a^n = {(a^2)}^{\frac{n- 1}{2}}\times a$ , 就是下面的代码所示
typedef long long ll; ll mod_pow(ll x, ll n, ll mod_k){ if(n == 0) return 1; ll res = mod_pow(x*x%mod_k, n/2, mod_k); if(n&amp;1) res = res*x%mod_k; return res; } 矩阵的快速幂运算 两个矩阵的快速运算为"/>

	
  </head>

  <body class="ma0 avenir bg-near-white">

    
   
  

  <header>
    <div class="bg-black">
      <nav class="pv3 ph3 ph4-ns" role="navigation">
  <div class="flex-l justify-between items-center center">
    <a href="/LinsenTaixian/" class="f3 fw2 hover-white no-underline white-90 dib">
      
        Linsen
      
    </a>
    <div class="flex-l items-center">
      

      
      















    </div>
  </div>
</nav>

    </div>
  </header>



    <main class="pb7" role="main">
      
  
  <article class="flex-l flex-wrap justify-between mw8 center ph3">
    <header class="mt4 w-100">
      <aside class="instapaper_ignoref b helvetica tracked">
          
        POSTS
      </aside>
      




  <div id="sharing" class="mt3">

    
    <a href="https://www.facebook.com/sharer.php?u=https://linsentaixian.github.io/LinsenTaixian/posts/project_1/" class="facebook no-underline" aria-label="share on Facebook">
      <svg height="32px"  style="enable-background:new 0 0 67 67;" version="1.1" viewBox="0 0 67 67" width="32px" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M28.765,50.32h6.744V33.998h4.499l0.596-5.624h-5.095  l0.007-2.816c0-1.466,0.14-2.253,2.244-2.253h2.812V17.68h-4.5c-5.405,0-7.307,2.729-7.307,7.317v3.377h-3.369v5.625h3.369V50.32z   M33,64C16.432,64,3,50.569,3,34S16.432,4,33,4s30,13.431,30,30S49.568,64,33,64z" style="fill-rule:evenodd;clip-rule:evenodd;"/></svg>

    </a>

    
    
    <a href="https://twitter.com/share?url=https://linsentaixian.github.io/LinsenTaixian/posts/project_1/&amp;text=project_1" class="twitter no-underline" aria-label="share on Twitter">
      <svg height="32px"  style="enable-background:new 0 0 67 67;" version="1.1" viewBox="0 0 67 67" width="32px" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M37.167,22.283c-2.619,0.953-4.274,3.411-4.086,6.101  l0.063,1.038l-1.048-0.127c-3.813-0.487-7.145-2.139-9.974-4.915l-1.383-1.377l-0.356,1.017c-0.754,2.267-0.272,4.661,1.299,6.271  c0.838,0.89,0.649,1.017-0.796,0.487c-0.503-0.169-0.943-0.296-0.985-0.233c-0.146,0.149,0.356,2.076,0.754,2.839  c0.545,1.06,1.655,2.097,2.871,2.712l1.027,0.487l-1.215,0.021c-1.173,0-1.215,0.021-1.089,0.467  c0.419,1.377,2.074,2.839,3.918,3.475l1.299,0.444l-1.131,0.678c-1.676,0.976-3.646,1.526-5.616,1.568  C19.775,43.256,19,43.341,19,43.405c0,0.211,2.557,1.397,4.044,1.864c4.463,1.377,9.765,0.783,13.746-1.568  c2.829-1.673,5.657-5,6.978-8.221c0.713-1.716,1.425-4.851,1.425-6.354c0-0.975,0.063-1.102,1.236-2.267  c0.692-0.678,1.341-1.419,1.467-1.631c0.21-0.403,0.188-0.403-0.88-0.043c-1.781,0.636-2.033,0.551-1.152-0.402  c0.649-0.678,1.425-1.907,1.425-2.267c0-0.063-0.314,0.042-0.671,0.233c-0.377,0.212-1.215,0.53-1.844,0.72l-1.131,0.361l-1.027-0.7  c-0.566-0.381-1.361-0.805-1.781-0.932C39.766,21.902,38.131,21.944,37.167,22.283z M33,64C16.432,64,3,50.569,3,34S16.432,4,33,4  s30,13.431,30,30S49.568,64,33,64z" style="fill-rule:evenodd;clip-rule:evenodd;fill:;"/></svg>

    </a>

    
    <a href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https://linsentaixian.github.io/LinsenTaixian/posts/project_1/&amp;title=project_1" class="linkedin no-underline" aria-label="share on LinkedIn">
      <svg  height="32px"  style="enable-background:new 0 0 65 65;" version="1.1" viewBox="0 0 65 65" width="32px" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
  <path d="M50.837,48.137V36.425c0-6.275-3.35-9.195-7.816-9.195  c-3.604,0-5.219,1.983-6.119,3.374V27.71h-6.79c0.09,1.917,0,20.427,0,20.427h6.79V36.729c0-0.609,0.044-1.219,0.224-1.655  c0.49-1.22,1.607-2.483,3.482-2.483c2.458,0,3.44,1.873,3.44,4.618v10.929H50.837z M22.959,24.922c2.367,0,3.842-1.57,3.842-3.531  c-0.044-2.003-1.475-3.528-3.797-3.528s-3.841,1.524-3.841,3.528c0,1.961,1.474,3.531,3.753,3.531H22.959z M34,64  C17.432,64,4,50.568,4,34C4,17.431,17.432,4,34,4s30,13.431,30,30C64,50.568,50.568,64,34,64z M26.354,48.137V27.71h-6.789v20.427  H26.354z" style="fill-rule:evenodd;clip-rule:evenodd;fill:;"/>
</svg>

    </a>
  </div>


      <h1 class="f1 athelas mt3 mb1">project_1</h1>
      
      
      <time class="f6 mv4 dib tracked" datetime="2020-10-29T20:25:00+08:00">October 29, 2020</time>

      
      
    </header>
    <div class="nested-copy-line-height lh-copy serif f4 nested-links nested-img mid-gray pr4-l w-two-thirds-l"><h1 id="快速幂运算和矩阵快速幂运算">快速幂运算和矩阵快速幂运算</h1>
<h2 id="快速幂运算">快速幂运算</h2>
<p>题:既求一个数的n次方,其中n特别大, 最后的结果对k取余</p>
<p>例如$ a^{22}$ 其中$ 22$的二进制表示为$ 10110$, 所以可以通过一直计算$ x$的平方, 然后在n的二进制为一的地方乘以res, 就可以得到下面的额算法</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c++" data-lang="c++"><span style="color:#66d9ef">typedef</span> <span style="color:#66d9ef">long</span> <span style="color:#66d9ef">long</span> ll;
ll <span style="color:#a6e22e">mod_pow</span>(ll x, ll n, ll mod_k){
    ll res <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>;
    <span style="color:#66d9ef">while</span>(n <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">0</span>){
        <span style="color:#66d9ef">if</span>(n<span style="color:#f92672">&amp;</span><span style="color:#ae81ff">1</span>) res <span style="color:#f92672">=</span> x<span style="color:#f92672">*</span>x<span style="color:#f92672">%</span>mod_k;
        x <span style="color:#f92672">=</span> x<span style="color:#f92672">*</span>x<span style="color:#f92672">%</span>mod_k;
        n<span style="color:#f92672">&gt;&gt;=</span> <span style="color:#ae81ff">1</span>;
    }
    <span style="color:#66d9ef">return</span> res;
}
</code></pre></div><p>或者:</p>
<p>或者也可以采用另外一种理解使用递归函数$n$ 为偶数时, 其递归是$a^n = (a^2)^{\frac{n}{2}}$ , 如果是奇数, 也可以递归成 $ a^n = {(a^2)}^{\frac{n- 1}{2}}\times a$ , 就是下面的代码所示</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c++" data-lang="c++"><span style="color:#66d9ef">typedef</span> <span style="color:#66d9ef">long</span> <span style="color:#66d9ef">long</span> ll;
ll <span style="color:#a6e22e">mod_pow</span>(ll x, ll n, ll mod_k){
    <span style="color:#66d9ef">if</span>(n <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>) <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">1</span>;
    ll res <span style="color:#f92672">=</span> mod_pow(x<span style="color:#f92672">*</span>x<span style="color:#f92672">%</span>mod_k, n<span style="color:#f92672">/</span><span style="color:#ae81ff">2</span>, mod_k);
    <span style="color:#66d9ef">if</span>(n<span style="color:#f92672">&amp;</span><span style="color:#ae81ff">1</span>) res <span style="color:#f92672">=</span> res<span style="color:#f92672">*</span>x<span style="color:#f92672">%</span>mod_k;
    <span style="color:#66d9ef">return</span> res;
}
</code></pre></div><h2 id="矩阵的快速幂运算">矩阵的快速幂运算</h2>
<p>两个矩阵的快速运算为</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c++" data-lang="c++"><span style="color:#66d9ef">int</span> <span style="color:#f92672">**</span> <span style="color:#a6e22e">mat</span>(<span style="color:#66d9ef">int</span><span style="color:#f92672">**</span> A, <span style="color:#66d9ef">int</span><span style="color:#f92672">**</span> B, <span style="color:#66d9ef">int</span> size){
    <span style="color:#66d9ef">int</span> <span style="color:#f92672">**</span> C <span style="color:#f92672">=</span> (<span style="color:#66d9ef">int</span><span style="color:#f92672">**</span>)malloc(<span style="color:#66d9ef">sizeof</span>(<span style="color:#66d9ef">int</span><span style="color:#f92672">*</span>)<span style="color:#f92672">*</span>size);
    <span style="color:#66d9ef">for</span>(<span style="color:#66d9ef">int</span> i<span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; i<span style="color:#f92672">&lt;</span> size;i<span style="color:#f92672">++</span>){
        C[i] <span style="color:#f92672">=</span> (<span style="color:#66d9ef">int</span><span style="color:#f92672">*</span>)malloc(<span style="color:#66d9ef">sizeof</span>(<span style="color:#66d9ef">int</span>)<span style="color:#f92672">*</span>size);
    }
    <span style="color:#66d9ef">for</span>(<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; i <span style="color:#f92672">&lt;</span> size;i<span style="color:#f92672">++</span>){
        <span style="color:#66d9ef">for</span>(<span style="color:#66d9ef">int</span> j <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; j <span style="color:#f92672">&lt;</span> size;j<span style="color:#f92672">++</span>){
            C[i][j] <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
            <span style="color:#66d9ef">for</span>(<span style="color:#66d9ef">int</span> k <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;k <span style="color:#f92672">&lt;</span> size;k<span style="color:#f92672">++</span>){
                C[i][j] <span style="color:#f92672">+=</span> A[i][k]<span style="color:#f92672">*</span>B[k][j];
            }
        }
    }
    <span style="color:#66d9ef">return</span> C;
</code></pre></div><p>快速幂运算为</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c++" data-lang="c++"><span style="color:#66d9ef">int</span> <span style="color:#f92672">**</span> <span style="color:#a6e22e">fun</span>(<span style="color:#66d9ef">int</span> <span style="color:#f92672">**</span> A, <span style="color:#66d9ef">int</span> size, <span style="color:#66d9ef">int</span> n){
    <span style="color:#66d9ef">int</span> <span style="color:#f92672">**</span> rec <span style="color:#f92672">=</span> (<span style="color:#66d9ef">int</span><span style="color:#f92672">**</span>)malloc(<span style="color:#66d9ef">sizeof</span>(<span style="color:#66d9ef">int</span><span style="color:#f92672">*</span>)<span style="color:#f92672">*</span>size);
    <span style="color:#66d9ef">for</span>(<span style="color:#66d9ef">int</span> i<span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; i<span style="color:#f92672">&lt;</span> size;i<span style="color:#f92672">++</span>){
        C[i] <span style="color:#f92672">=</span> (<span style="color:#66d9ef">int</span><span style="color:#f92672">*</span>)malloc(<span style="color:#66d9ef">sizeof</span>(<span style="color:#66d9ef">int</span>)<span style="color:#f92672">*</span>size);
    }
    <span style="color:#66d9ef">for</span>(<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; i <span style="color:#f92672">&lt;</span> size;i<span style="color:#f92672">++</span>){
        <span style="color:#66d9ef">for</span>(<span style="color:#66d9ef">int</span> j <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;j <span style="color:#f92672">&lt;</span> size;j<span style="color:#f92672">++</span>){
            rec[i][j] <span style="color:#f92672">=</span> i <span style="color:#f92672">==</span> j <span style="color:#f92672">?</span> <span style="color:#ae81ff">1</span> <span style="color:#f92672">:</span> <span style="color:#ae81ff">0</span>;
        }
    }
    <span style="color:#66d9ef">while</span>(n){
        <span style="color:#66d9ef">if</span>(n<span style="color:#f92672">&amp;</span><span style="color:#ae81ff">1</span>) mat(rec, A);
        mat(A, A);
        n<span style="color:#f92672">&gt;&gt;=</span> <span style="color:#ae81ff">1</span>;
    }
    <span style="color:#66d9ef">return</span> rec;
}
</code></pre></div><h3 id="例题">例题:</h3>
<p>罗姆的常系数齐次线性递推</p>
<p>空间限制:32MB</p>
<p>时间限制:1000ms</p>
<hr>
<h4 id="背景故事">背景故事</h4>
<p><em>出题人遇到了被偷了徽章的艾米莉亚，他们一起寻找徽章，最后锁定在一家赃物店里，却没有想到，两人相继进店，相继被杀。</em></p>
<p><em>出题人发现自己拥有死亡回归的能力，读档复活了。出题人又遇见了艾米莉亚，然而艾米莉亚却一副不认识出题人的样子，出题人一脸茫然。</em></p>
<p><em>不知所措的出题人决定先去店里赎回徽章。来到店里，这里只有罗姆老爷爷，和一个小女孩。</em></p>
<p><em>罗姆：“你拿什么来赎？”</em></p>
<h4 id="题目描述">题目描述</h4>
<p><img src="https://github.com/LinsenTaixian/images/blob/master/images1/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE(233).png" alt="a photo about the question"></p>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<p><strong>本题附有提示，但在阅读提示前请务必进行充分的独立思考，否则对你的学习能力提升没有意义。</strong></p>
<h4 id="输入格式">输入格式</h4>
<p>第一行两个正整数 k,nk,n。（1≤k≤201≤k≤20，k≤n≤1018k≤n≤1018）</p>
<p>第二行 kk 个整数，表示 a1,⋯,aka1,⋯,ak。</p>
<p>第三行 kk 个整数，表示 c1,⋯,ckc1,⋯,ck。（1≤ai,ci≤1091≤ai,ci≤109）</p>
<h4 id="输出格式">输出格式</h4>
<p>一行，一个整数，表示 fnfn 对 109+7109+7 取模。</p>
<h4 id="样例输入1">样例输入1</h4>
<p>2 6</p>
<p>1 1</p>
<p>1 1</p>
<h4 id="样例输出1">样例输出1</h4>
<p>8</p>
<h4 id="样例输入2">样例输入2</h4>
<p>3 6</p>
<p>1 2 3</p>
<p>3 2 1</p>
<h4 id="样例输出2">样例输出2</h4>
<p>181</p>
<h4 id="提示1">提示1</h4>
<p>聪明的你一定学过线性代数，我们来简单应用一下。</p>
<p>考虑斐波那契数列 fn=fn−1+fn−2fn=fn−1+fn−2，我们构造一个向量 <em>[Math Processing Error]</em>，把它乘一个矩阵 <em>[Math Processing Error]</em>，会得到什么呢？ <em>[Math Processing Error]</em></p>
<p>会发现 ff 的下标往前推进了一位！这就产生了递推！</p>
<p>聪明的你一定想到了扩展到常系数齐次线性递推要怎么做。</p>
<h4 id="提示2">提示2</h4>
<p>给定 x,yx,y，而 yy 很大，要怎么求 xyxy 呢？</p>
<p>如果 yy 是偶数，你可以先求 xy2xy2，然后给它平方一下；</p>
<p>如果 yy 是奇数，你可以先求 xy−12xy−12，然后给它平方一下，然后再乘个 xx。</p>
<p>聪明的你一定知道这样做的时间复杂度是多少。</p>
<h4 id="提示3">提示3</h4>
<p>离散课本里好像还给出了一种直接解特征方程的方法呢！哪个方法比较好呢？课本里的方法能不能用在这个题里呢？两种方法有什么联系呢？能不能互相推导出来呢？</p>
<p>聪明的你一定被激发了学习的热情！</p>
<h3 id="分析">分析:</h3>
<h1 id="endbmatrix">$$
\begin{bmatrix}
a_{k + 1}\<br>
a_{k}\<br>
a_{k - 1}\<br>
\vdots\<br>
a_2\<br>
\end{bmatrix}</h1>
<p>\begin{bmatrix}
c_k&amp; c_{k - 1}&amp; \cdots&amp;c_2&amp; c_1\<br>
1&amp;0&amp;\cdots&amp;0&amp;0\<br>
0&amp; 1&amp; \cdots&amp; 0&amp;0\<br>
\vdots&amp;\vdots&amp;\ddots&amp;\vdots&amp;\vdots\<br>
0&amp;0&amp;\cdots&amp;1&amp;0
\end{bmatrix}
\begin{bmatrix}
a_k\<br>
a_{k - 1}\<br>
a_{k - 2}\<br>
\vdots\<br>
a_1
\end{bmatrix}
$$</p>
<p>所以可以令:
$$
A=
\begin{bmatrix}
c_k&amp; c_{k - 1}&amp; \cdots&amp;c_2&amp; c_1\<br>
1&amp;0&amp;\cdots&amp;0&amp;0\<br>
0&amp; 1&amp; \cdots&amp; 0&amp;0\<br>
\vdots&amp;\vdots&amp;\ddots&amp;\vdots&amp;\vdots\<br>
0&amp;0&amp;\cdots&amp;1&amp;0
\end{bmatrix}
$$
那么就有:
$$
a^n = A^{n- k}\times
\begin{bmatrix}
a_k\<br>
a_{k - 1}\<br>
a_{k - 2}\<br>
\vdots\<br>
a_1
\end{bmatrix}
$$
那么就可以用快速矩阵来计算$A^{n - k}$ 了</p>
<h3 id="题解代码">题解代码</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c++" data-lang="c++"><span style="color:#75715e">#include</span><span style="color:#75715e">&lt;stdio.h&gt;</span><span style="color:#75715e">
</span><span style="color:#75715e">#include</span><span style="color:#75715e">&lt;stdlib.h&gt;</span><span style="color:#75715e">
</span><span style="color:#75715e">#include</span><span style="color:#75715e">&lt;string.h&gt;</span><span style="color:#75715e">
</span><span style="color:#75715e">#include</span><span style="color:#75715e">&lt;math.h&gt;</span><span style="color:#75715e">
</span><span style="color:#75715e"></span>
<span style="color:#66d9ef">long</span> <span style="color:#66d9ef">long</span> <span style="color:#66d9ef">int</span> mat1[<span style="color:#ae81ff">20</span>][<span style="color:#ae81ff">20</span>], mat2[<span style="color:#ae81ff">20</span>][<span style="color:#ae81ff">20</span>];
<span style="color:#66d9ef">long</span> <span style="color:#66d9ef">long</span> <span style="color:#66d9ef">int</span> mod <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>, ans <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
<span style="color:#66d9ef">long</span> <span style="color:#66d9ef">long</span> <span style="color:#66d9ef">int</span> tem[<span style="color:#ae81ff">20</span>];
<span style="color:#66d9ef">long</span> <span style="color:#66d9ef">long</span> <span style="color:#66d9ef">int</span> k <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>, n <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;

<span style="color:#66d9ef">void</span> <span style="color:#a6e22e">mut</span>(<span style="color:#66d9ef">int</span> mo){
    <span style="color:#66d9ef">int</span> thistime[<span style="color:#ae81ff">20</span>][<span style="color:#ae81ff">20</span>];
    <span style="color:#66d9ef">if</span>(mo <span style="color:#f92672">==</span> <span style="color:#ae81ff">1</span>){
        <span style="color:#66d9ef">for</span>(<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; i <span style="color:#f92672">&lt;</span> k;i<span style="color:#f92672">++</span>){
            <span style="color:#66d9ef">for</span>(<span style="color:#66d9ef">int</span> j <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; j <span style="color:#f92672">&lt;</span> k;j<span style="color:#f92672">++</span>){
                thistime[i][j] <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
                <span style="color:#66d9ef">for</span>(<span style="color:#66d9ef">int</span> r <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; r <span style="color:#f92672">&lt;</span> k;r<span style="color:#f92672">++</span>){
                    thistime[i][j] <span style="color:#f92672">=</span> (thistime[i][j] <span style="color:#f92672">+</span> mat1[i][r]<span style="color:#f92672">*</span>mat1[r][j])<span style="color:#f92672">%</span>mod;
                }
            }
        }
        <span style="color:#66d9ef">for</span>(<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; i <span style="color:#f92672">&lt;</span> k;i<span style="color:#f92672">++</span>){
            <span style="color:#66d9ef">for</span>(<span style="color:#66d9ef">int</span> j <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; j <span style="color:#f92672">&lt;</span> k;j<span style="color:#f92672">++</span>){
                mat1[i][j] <span style="color:#f92672">=</span> thistime[i][j];
            }
        }
    }
    <span style="color:#66d9ef">else</span>{
        <span style="color:#66d9ef">for</span>(<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; i <span style="color:#f92672">&lt;</span> k;i<span style="color:#f92672">++</span>){
            <span style="color:#66d9ef">for</span>(<span style="color:#66d9ef">int</span> j <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; j <span style="color:#f92672">&lt;</span> k;j<span style="color:#f92672">++</span>){
                thistime[i][j] <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
                <span style="color:#66d9ef">for</span>(<span style="color:#66d9ef">int</span> r <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; r <span style="color:#f92672">&lt;</span> k;r<span style="color:#f92672">++</span>){
                    thistime[i][j] <span style="color:#f92672">=</span> (thistime[i][j] <span style="color:#f92672">+</span> mat2[i][r]<span style="color:#f92672">*</span>mat1[r][j])<span style="color:#f92672">%</span>mod;
                }
            }
        }
        <span style="color:#66d9ef">for</span>(<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; i <span style="color:#f92672">&lt;</span> k;i<span style="color:#f92672">++</span>){
            <span style="color:#66d9ef">for</span>(<span style="color:#66d9ef">int</span> j <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; j <span style="color:#f92672">&lt;</span> k;j<span style="color:#f92672">++</span>){
                mat2[i][j] <span style="color:#f92672">=</span> thistime[i][j];
            }
        }
    }
}

<span style="color:#66d9ef">void</span> <span style="color:#a6e22e">pow_mod</span>(<span style="color:#66d9ef">void</span>){
    <span style="color:#66d9ef">while</span>(n <span style="color:#f92672">&gt;</span><span style="color:#ae81ff">0</span>){
        <span style="color:#66d9ef">if</span>(n<span style="color:#f92672">&amp;</span><span style="color:#ae81ff">1</span>) mut(<span style="color:#ae81ff">2</span>);
        mut(<span style="color:#ae81ff">1</span>);
        n <span style="color:#f92672">&gt;&gt;=</span> <span style="color:#ae81ff">1</span>;
    }
}

<span style="color:#66d9ef">int</span> <span style="color:#a6e22e">main</span>(){
    mod <span style="color:#f92672">=</span> pow(<span style="color:#ae81ff">10</span>,<span style="color:#ae81ff">9</span>) <span style="color:#f92672">+</span> <span style="color:#ae81ff">7</span>;
    scanf(<span style="color:#e6db74">&#34;%lld %lld&#34;</span>, <span style="color:#f92672">&amp;</span>k, <span style="color:#f92672">&amp;</span>n);
    n <span style="color:#f92672">=</span> n <span style="color:#f92672">-</span> k;
    <span style="color:#66d9ef">for</span>(<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; i <span style="color:#f92672">&lt;</span> k;i<span style="color:#f92672">++</span>){
        scanf(<span style="color:#e6db74">&#34;%lld&#34;</span>, <span style="color:#f92672">&amp;</span>tem[i]);
    }
    <span style="color:#66d9ef">for</span>(<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; i <span style="color:#f92672">&lt;</span> k;i<span style="color:#f92672">++</span>){
        scanf(<span style="color:#e6db74">&#34;%lld&#34;</span>, <span style="color:#f92672">&amp;</span>mat1[<span style="color:#ae81ff">0</span>][i]);
    }
    <span style="color:#66d9ef">for</span>(<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>; i <span style="color:#f92672">&lt;</span> k;i<span style="color:#f92672">++</span>){
        mat1[i][i <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>;
    }
    <span style="color:#66d9ef">for</span>(<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; i <span style="color:#f92672">&lt;</span> k;i<span style="color:#f92672">++</span>){
        mat2[i][i] <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>;
    }
    pow_mod();
    <span style="color:#66d9ef">for</span>(<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;i <span style="color:#f92672">&lt;</span> k;i<span style="color:#f92672">++</span>){
        ans <span style="color:#f92672">=</span> (ans <span style="color:#f92672">+</span> tem[k <span style="color:#f92672">-</span> i <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>]<span style="color:#f92672">*</span>mat2[<span style="color:#ae81ff">0</span>][i])<span style="color:#f92672">%</span>mod;
    }
    printf(<span style="color:#e6db74">&#34;%lld</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>, ans);
    <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>;
}
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c++" data-lang="c++"><span style="color:#960050;background-color:#1e0010">输入</span><span style="color:#f92672">:</span>
<span style="color:#ae81ff">3</span> <span style="color:#ae81ff">6</span>
<span style="color:#ae81ff">1</span> <span style="color:#ae81ff">2</span> <span style="color:#ae81ff">3</span>
<span style="color:#ae81ff">3</span> <span style="color:#ae81ff">2</span> <span style="color:#ae81ff">1</span>
<span style="color:#960050;background-color:#1e0010">输出</span><span style="color:#f92672">:</span>
<span style="color:#ae81ff">181</span>
</code></pre></div><ul class="pa0">
  
</ul>
<div class="mt6 instapaper_ignoref">
      
      
      </div>
    </div>

    <aside class="w-30-l mt6-l">




</aside>

  </article>

    </main>
    <footer class="bg-black bottom-0 w-100 pa3" role="contentinfo">
  <div class="flex justify-between">
  <a class="f4 fw4 hover-white no-underline white-70 dn dib-ns pv2 ph3" href="https://linsentaixian.github.io/LinsenTaixian/" >
    &copy;  Linsen 2020 
  </a>
    <div>














</div>
  </div>
</footer>

    

  <script src="/LinsenTaixian/dist/js/app.3fc0f988d21662902933.js"></script>


  </body>
</html>
